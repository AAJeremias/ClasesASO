# Crear usuarios, grupos, OU's y todo lo que quieras, leyendo de una página web
```PowerShell
# Crea un usuario en un lugar determinado
$usuario = "juan"
New-ADUSer -Name $usuario -Sam $usuario -Path "OU=Localizacion,DC=Dominio,DC=Local" -AccountPassword (ConvertTo-SecureString "Contra$ena" -AsPlainText -force) -Enable $true

# Crear una UO con una descripción
New-ADOrganizationalUnit -Name $usuario -Description "Ejemplo"

##################################

$url="http://localhost:8083/"
$result = Invoke-WebRequest $url
$result | select *
$var = ($result.RawContent -split "'n")
foreach($elementos in ($var.split("*"))[1..($var.split("*").length-2)])
{
    $elementos.split(",")[0]
}

##################################

foreach($elemento in Get-Content .\crear.txt)
{
    $elemento
    New-ADUSer -Name $elemento -Sam $elemento -Path "OU=Localizacion,DC=Dominio,DC=Local" -AccountPassword (ConvertTo-SecureString "Contra$ena" -AsPlainText -force) -Enable $true
    Start-Sleep -Seconds 5
}

foreach($elemento in Get-Content .\crear.txt)
{
    $elemento.split(",")[0]
}

foreach($elemento in Get-Content .\crear.txt)
{
    if($elemento.split(",")[0] -eq 1)
    {
        "crear ou " + $elemento.split(",")[1]
        New-ADOrganizationalUnit -Name $elemento.split(",")[1] -Description "Ejemplo"
    }
    
    if($elemento.split(",")[0] -eq 2)
    {
        "crear user " + $elemento.split(",")[1]
        New-ADUSer -Name $elemento.split(",")[1] -Sam $elemento.split(",")[1] -Path "OU=Localizacion,DC=Dominio,DC=Local" -AccountPassword (ConvertTo-SecureString "Contra$ena" -AsPlainText -force) -Enable $true
    }

    if($elemento.split(",")[0] -eq 4)
    {
        "existe un usuario" + $elemento.split(",")[1]
        $SAMAccountName = $elemento.split(",")[1]
        Get-ADUser -LDAPFilter "(samaccountname=$SAMAccountName)"
    }
}
```
# Generar un codigo QR para cada usuario
```PowerShell
foreach($elemento in Get-Content .\crear.txt)
{
    $texto = $elemento.split(",")[1]
    wsl echo $texto
    wsl qrencode -o qrcode.png $texto
    wsl ls qrcode.png
    .\qrcode.png
}
```
